<mxfile host="app.diagrams.net" modified="2024-03-20T16:37:59.792Z" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.6 Safari/605.1.15" etag="hPOvXmrpkd8fjQBu1Uty" version="24.0.7" type="github">
  <diagram name="Page-1" id="oxT93REgdBnrsqCUNy76">
    <mxGraphModel dx="940" dy="738" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="N2UJYiBVN7IEDLmHxjyJ-4" value="client" style="shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top;html=1;outlineConnect=0;" parent="1" vertex="1">
          <mxGeometry x="360" y="100" width="30" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bE4lquNDYk41hHukXNN1-1" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="374.5" y="190" as="sourcePoint" />
            <mxPoint x="374.5" y="280" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bE4lquNDYk41hHukXNN1-8" value="get request" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="350" y="200" width="130" height="40" as="geometry" />
        </mxCell>
        <mxCell id="bE4lquNDYk41hHukXNN1-9" value="DNS: domain -&amp;gt; ip&amp;nbsp;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="320" y="260" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bE4lquNDYk41hHukXNN1-10" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="374.5" y="300" as="sourcePoint" />
            <mxPoint x="374.5" y="370" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bE4lquNDYk41hHukXNN1-13" value="сервер" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="200" y="340" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="bE4lquNDYk41hHukXNN1-17" value="" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="200" y="380" width="260" height="240" as="geometry" />
        </mxCell>
        <mxCell id="bE4lquNDYk41hHukXNN1-29" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="bE4lquNDYk41hHukXNN1-19" target="bE4lquNDYk41hHukXNN1-21">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bE4lquNDYk41hHukXNN1-19" value="Девопс: nginx/candy/apache" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="220" y="390" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="bE4lquNDYk41hHukXNN1-21" value="" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="210" y="440" width="240" height="170" as="geometry" />
        </mxCell>
        <mxCell id="bE4lquNDYk41hHukXNN1-25" value="контэйнер: docker" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="230" y="430" width="110" height="50" as="geometry" />
        </mxCell>
        <mxCell id="bE4lquNDYk41hHukXNN1-27" value="&lt;div style=&quot;text-align: center;&quot;&gt;&lt;br&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="470" y="440" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="bE4lquNDYk41hHukXNN1-28" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;Примечание:&lt;/b&gt; в контейнере может тоже быть куча своих сервисов: серверы, логгеры, иногда бд для кэша, батч сервисы, брокеры, снова nginx и пр&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;пусть у нас контэйнер будет передавать инфу с node js или просто отдавать статику.&lt;/span&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="480" y="380" width="195" height="170" as="geometry" />
        </mxCell>
        <mxCell id="bE4lquNDYk41hHukXNN1-30" value="node js" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="220" y="480" width="220" height="50" as="geometry" />
        </mxCell>
        <mxCell id="bE4lquNDYk41hHukXNN1-31" value="" style="endArrow=none;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="70" y="190" as="sourcePoint" />
            <mxPoint x="660" y="190" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bE4lquNDYk41hHukXNN1-33" value="статика (без ssr)" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="220" y="540" width="70" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bE4lquNDYk41hHukXNN1-34" value="ssr" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="295" y="512" width="70" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bE4lquNDYk41hHukXNN1-35" value="статика (ssr)" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="370" y="512" width="70" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bE4lquNDYk41hHukXNN1-38" value="middlewares" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="220" y="512" width="220" height="18" as="geometry" />
        </mxCell>
        <mxCell id="bE4lquNDYk41hHukXNN1-43" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="290" y="440" as="sourcePoint" />
            <mxPoint x="290" y="420" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bE4lquNDYk41hHukXNN1-44" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.538;exitY=-0.003;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="1" source="bE4lquNDYk41hHukXNN1-17">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="240" y="470" as="sourcePoint" />
            <mxPoint x="100" y="160" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bE4lquNDYk41hHukXNN1-47" value="Text" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="230" y="420" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="bE4lquNDYk41hHukXNN1-48" value="&lt;b&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;Middlewares&lt;/font&gt;&lt;/b&gt;&lt;div&gt;&lt;font size=&quot;4&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/font&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;Вообще может быть что угодно. обычно это middleware которые проверяют права, авторизацию, логгируют и пр.&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;Если все ок то будет доступ к контенту/обработке дальнейшей локиги. Если нет - вернут ошибку.&amp;nbsp;&lt;/font&gt;&lt;/font&gt;например&amp;nbsp;401/403 если что то не так с аутентификацией&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="480" y="570" width="230" height="260" as="geometry" />
        </mxCell>
        <mxCell id="bE4lquNDYk41hHukXNN1-49" value="&lt;font size=&quot;4&quot;&gt;&lt;b&gt;3 варианта отдать фронтенд&lt;/b&gt;&lt;/font&gt;&lt;div&gt;&lt;font size=&quot;4&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font size=&quot;4&quot;&gt;&lt;b&gt;1) отдать просто статику без ssr&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;вариант для сервисов, где не нужен ssr. вообще лучше отдавать каким нибудь nginx. через node js только, если к нему нужно запросить от пользователя доступ или какую то другую логику (посмотреть на агента, ip и тд)&lt;/div&gt;&lt;div&gt;&lt;font size=&quot;4&quot;&gt;&lt;b&gt;2) во время запроса сделать рендер, отдать уже готовый html&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;не самый хороший вариант подходит, если нужно что то маленькое отдать. так требует много северного времени пользователям долго ждать первого байта&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;font size=&quot;4&quot;&gt;&lt;b&gt;3) во время билда подготовить все страницы. сразу их отдавать как статику&lt;br&gt;&lt;/b&gt;&lt;/font&gt;&lt;div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;Лучший вариант. Сложнее сделать, чем первые два. Обычно работает быстрее 2 но медленнее 1&lt;/span&gt;&lt;span style=&quot;&quot;&gt;, однако на клиенте не надо будет ждать пока js соберет рендер.&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;В идеале - после загрузки страницы чанками загрузить остальные страницы. далее переходить по ним без запросов к серверу (SPA): так сделано например в next js&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="180" y="740" width="290" height="420" as="geometry" />
        </mxCell>
        <mxCell id="bE4lquNDYk41hHukXNN1-52" value="1) если у нас ssr - пользователь сразу получит html&amp;nbsp;&lt;div&gt;2) прогрузятся стили и скрипты&lt;/div&gt;&lt;div&gt;3) если у нас ssr - нужно сделать гидрацию повесить слушатели на все события, кнопочки и формочки. Если его нету - браузер сам отрендерит приложение&lt;/div&gt;" style="text;html=1;whiteSpace=wrap;overflow=hidden;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="60" y="40" width="270" height="200" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
